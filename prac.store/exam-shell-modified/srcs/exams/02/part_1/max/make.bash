#!/bin/bash

clang -Wall -Werror -Wextra max.c main.c -o max || exit 100
./max 12 52 19 82 44 21 36 32 90 37 89 14 79 > real
./max 8 -7 69 -50 28 34 -38 37 -47 >> real
./max 15 -39 107 119 93 53 -36 81 131 69 -1 129 -52 74 47 -26 >> real
./max 48 110 60 18 -29 74 26 -62 -7 36 90 -64 35 126 91 24 -9 79 -32 37 -10 9 17 137 -56 14 11 46 64 -33 5 69 54 95 -31 -78 -81 -35 122 -85 -57 -73 87 -21 101 130 98 112 107 >> real

clang -Wall -Werror -Wextra $1/max/max.c main.c -o max2
./max2 12 52 19 82 44 21 36 32 90 37 89 14 79 > fake
./max2 8 -7 69 -50 28 34 -38 37 -47 >> fake
./max2 15 -39 107 119 93 53 -36 81 131 69 -1 129 -52 74 47 -26 >> fake
./max2 48 110 60 18 -29 74 26 -62 -7 36 90 -64 35 126 91 24 -9 79 -32 37 -10 9 17 137 -56 14 11 46 64 -33 5 69 54 95 -31 -78 -81 -35 122 -85 -57 -73 87 -21 101 130 98 112 107 >> fake

diff -y --suppress-common-lines real fake > __diff
bash leaks.bash max2 0 15 -39 107 119 93 53 -36 81 131 69 -1 129 -52 74 47 -26 > /dev/null 2>&1

rm -rf max max2 real fake
